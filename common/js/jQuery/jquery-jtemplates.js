window.jQuery&&!window.jQuery.createTemplate&&function(jQuery){var Template=function(e,t,a){this._tree=[],this._param={},this._includes=null,this._templates={},this._templates_code={},this.settings=jQuery.extend({disallow_functions:!1,filter_data:!0,filter_params:!1,runnable_functions:!1,clone_data:!0,clone_params:!0},a),this.f_cloneData=void 0!==this.settings.f_cloneData?this.settings.f_cloneData:TemplateUtils.cloneData,this.f_escapeString=void 0!==this.settings.f_escapeString?this.settings.f_escapeString:TemplateUtils.escapeHTML,this.f_parseJSON=void 0!==this.settings.f_parseJSON?this.settings.f_parseJSON:this.settings.disallow_functions?jQuery.parseJSON:TemplateUtils.parseJSON,null!=e&&(this.splitTemplates(e,t),e&&this.setTemplate(this._templates_code.MAIN,t,this.settings),this._templates_code=null)};Template.version="0.8.3",Template.DEBUG_MODE=!1,Template.FOREACH_LOOP_LIMIT=1e4,Template.guid=0,Template.prototype.splitTemplates=function(e,t){for(var a,n,i,r,s=/\{#template *(\w+) *(.*?) *\}/g,o=null,l=[];null!==(a=s.exec(e));){if(o=s.lastIndex,n=a[1],-1===(i=e.indexOf("{#/template "+n+"}",o)))throw new Error('jTemplates: Template "'+n+'" is not closed.');this._templates_code[n]=e.substring(o,i),l[n]=TemplateUtils.optionToObject(a[2])}if(null!==o){for(r in this._templates_code)"MAIN"!==r&&(this._templates[r]=new Template);for(r in this._templates_code)"MAIN"!==r&&(this._templates[r].setTemplate(this._templates_code[r],jQuery.extend({},t||{},this._templates||{}),jQuery.extend({},this.settings,l[r])),this._templates_code[r]=null)}else this._templates_code.MAIN=e},Template.prototype.setTemplate=function(e,t,a){if(void 0!=e){e=(e=e.replace(/[\n\r]/g,"")).replace(/\{\*.*?\*\}/g,""),this._includes=jQuery.extend({},this._templates||{},t||{}),this.settings=new Object(a);var n,i,r,s=this._tree,o=e.match(/\{#.*?\}/g),l=0,u=0,p=0;for(i=0,r=o?o.length:0;i<r;++i){var h=o[i];if(p){if(-1===(u=e.indexOf("{#/literal}")))throw new Error("jTemplates: No end of literal.");u>l&&s.push(new TextNode(e.substring(l,u),1,this)),l=u+11,p=0,i=jQuery.inArray("{#/literal}",o)}else{(u=e.indexOf(h,l))>l&&s.push(new TextNode(e.substring(l,u),p,this)),h.match(/\{#([\w\/]+).*?\}/);var c=RegExp.$1;switch(c){case"elseif":s.addCond(h);break;case"if":(n=new opIF(s,this)).addCond(h),s.push(n),s=n;break;case"else":s.switchToElse();break;case"/if":case"/for":case"/foreach":s=s.getParent();break;case"foreach":n=new opFOREACH(h,s,this),s.push(n),s=n;break;case"for":n=opFORFactory(h,s,this),s.push(n),s=n;break;case"continue":case"break":s.push(new JTException(c));break;case"include":s.push(new Include(h,this._includes,this));break;case"param":s.push(new UserParam(h,this));break;case"var":s.push(new UserVariable(h,this));break;case"cycle":s.push(new Cycle(h));break;case"ldelim":s.push(new TextNode("{",1,this));break;case"rdelim":s.push(new TextNode("}",1,this));break;case"literal":p=1;break;case"/literal":if(Template.DEBUG_MODE)throw new Error("jTemplates: Missing begin of literal.");break;default:if(Template.DEBUG_MODE)throw new Error("jTemplates: unknown tag: "+c+".")}l=u+h.length}}e.length>l&&s.push(new TextNode(e.substr(l),p,this))}else this._tree.push(new TextNode("",1,this))},Template.prototype.get=function(e,t,a,n){1==++n&&void 0!=a&&jQuery.removeData(a,"jTemplatesRef");var i,r=e,s="";this.settings.clone_data&&(r=this.f_cloneData(e,{escapeData:this.settings.filter_data&&1==n,noFunc:this.settings.disallow_functions},this.f_escapeString)),i=this.settings.clone_params?jQuery.extend({},this.f_cloneData(this._param,{escapeData:this.settings.filter_params,noFunc:!1},this.f_escapeString),this.f_cloneData(t,{escapeData:this.settings.filter_params&&1==n,noFunc:!1},this.f_escapeString)):jQuery.extend({},this._param,t);for(var o=0,l=this._tree.length;o<l;++o)s+=this._tree[o].get(r,i,a,n);return this.EvalObj=null,--n,s},Template.prototype.getBin=function(){return null==this.EvalObj&&(this.EvalObj=new EvalClass(this)),this.EvalObj},Template.prototype.setParam=function(e,t){this._param[e]=t},TemplateUtils=function(){},TemplateUtils.escapeHTML=function(e){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},TemplateUtils.cloneData=function(e,t,a){if(null==e)return e;switch(e.constructor){case Object:var n={};for(var i in e)n[i]=TemplateUtils.cloneData(e[i],t,a);return t.noFunc||e.hasOwnProperty("toString")&&(n.toString=e.toString),n;case Array:for(var r=[],s=(i=0,e.length);i<s;++i)r[i]=TemplateUtils.cloneData(e[i],t,a);return r;case String:return t.escapeData?a(e):e;case Function:if(t.noFunc){if(Template.DEBUG_MODE)throw new Error("jTemplates: Functions are not allowed.");return}}return e},TemplateUtils.optionToObject=function(e){if(null===e||void 0===e)return{};var t=e.split(/[= ]/);""===t[0]&&t.shift();for(var a={},n=0,i=t.length;n<i;n+=2)a[t[n]]=t[n+1];return a},TemplateUtils.parseJSON=function(e){if("string"!=typeof e||!e)return null;try{return new Function("return "+jQuery.trim(e))()}catch(e){if(Template.DEBUG_MODE)throw new Error("jTemplates: Invalid JSON");return{}}},TemplateUtils.ReturnRefValue=function(e,t,a){for(;null!=e;){var n=jQuery.data(e,"jTemplatesRef");if(void 0!=n&&n.guid==t&&void 0!=n.d[a])return n.d[a];e=e.parentNode}return null};var TextNode=function(e,t,a){this._value=e,this._literalMode=t,this._template=a};TextNode.prototype.get=function(e,t,a,n){if(this._literalMode)return this._value;for(var i=this._value,r="",s=-1,o=0,l=-1,u=0;;){var p=i.indexOf("{",s+1),h=i.indexOf("}",s+1);if(p<0&&h<0)break;-1!=p&&p<h||-1==h?(s=p,1==++o&&(l=p,r+=i.substring(u,s),u=-1)):(s=h,0==--o?l>=0&&(r+=this._template.getBin().evaluateContent(e,t,a,i.substring(l,h+1)),l=-1,u=s+1):o<0&&(o=0))}return u>-1&&(r+=i.substr(u)),r},EvalClass=function(e){this.__templ=e},EvalClass.prototype.evaluateContent=function($T,$P,$Q,__value){try{var result=eval(__value);if(jQuery.isFunction(result)){if(this.__templ.settings.disallow_functions||!this.__templ.settings.runnable_functions)return"";result=result($T,$P,$Q)}return void 0===result?"":String(result)}catch(e){if(Template.DEBUG_MODE)throw e instanceof JTException&&(e.type="subtemplate"),e;return""}},EvalClass.prototype.evaluate=function($T,$P,$Q,__value){return eval(__value)};var opIF=function(e,t){this._parent=e,this._templ=t,this._cond=[],this._tree=[],this._curr=null};opIF.prototype.push=function(e){this._curr.push(e)},opIF.prototype.getParent=function(){return this._parent},opIF.prototype.addCond=function(e){e.match(/\{#(?:else)*if (.*?)\}/),this._cond.push(RegExp.$1),this._curr=[],this._tree.push(this._curr)},opIF.prototype.switchToElse=function(){this._cond.push(!0),this._curr=[],this._tree.push(this._curr)},opIF.prototype.get=function(e,t,a,n){var i="";try{for(var r=0,s=this._cond.length;r<s;++r)if(this._templ.getBin().evaluate(e,t,a,this._cond[r])){for(var o=this._tree[r],l=0,u=o.length;l<u;++l)i+=o[l].get(e,t,a,n);return i}}catch(e){if(Template.DEBUG_MODE||e instanceof JTException)throw e}return i},opFORFactory=function(e,t,a){if(e.match(/\{#for (\w+?) *= *(\S+?) +to +(\S+?) *(?:step=(\S+?))*\}/)){var n=new opFOREACH(null,t,a);return n._name=RegExp.$1,n._option={begin:RegExp.$2||0,end:RegExp.$3||-1,step:RegExp.$4||1,extData:"$T"},n._runFunc=function(e){return e},n}throw new Error('jTemplates: Operator failed "find": '+e)};var opFOREACH=function(e,t,a){this._parent=t,this._template=a,null!=e&&(e.match(/\{#foreach +(.+?) +as +(\w+?)( .+)*\}/),this._arg=RegExp.$1,this._name=RegExp.$2,this._option=RegExp.$3||null,this._option=TemplateUtils.optionToObject(this._option)),this._onTrue=[],this._onFalse=[],this._currentState=this._onTrue};opFOREACH.prototype.push=function(e){this._currentState.push(e)},opFOREACH.prototype.getParent=function(){return this._parent},opFOREACH.prototype.switchToElse=function(){this._currentState=this._onFalse},opFOREACH.prototype.get=function(e,t,a,n){try{var i=void 0===this._runFunc?this._template.getBin().evaluate(e,t,a,this._arg):this._runFunc;if(i===$)throw new Error("jTemplate: Variable '$' cannot be used as loop-function");var r=[],s=typeof i;if("object"==s){var o=[];jQuery.each(i,function(e,t){r.push(e),o.push(t)}),i=o}var l=void 0!==this._option.extData?this._template.getBin().evaluate(e,t,a,this._option.extData):null!=e?e:{};null==l&&(l={});var u,p=Number(this._template.getBin().evaluate(e,t,a,this._option.begin)||0),h=Number(this._template.getBin().evaluate(e,t,a,this._option.step)||1);u="function"!=s?i.length:void 0===this._option.end||null===this._option.end?Number.MAX_VALUE:Number(this._template.getBin().evaluate(e,t,a,this._option.end))+(h>0?1:-1);var c,_,m="";if(this._option.count){var f=p+Number(this._template.getBin().evaluate(e,t,a,this._option.count));u=f>u?u:f}if(u>p&&h>0||u<p&&h<0)for(var d,T,g=0,y="function"!=s?Math.ceil((u-p)/h):void 0,v=0;h>0?p<u:p>u;p+=h,++g,++v){if(Template.DEBUG_MODE&&v>Template.FOREACH_LOOP_LIMIT)throw new Error("jTemplate: Foreach loop limit was exceed");if(d=r[p],"function"!=s)T=i[p];else if(void 0===(T=i(p))||null===T)break;if(("function"!=typeof T||!this._template.settings.disallow_functions&&this._template.settings.runnable_functions)&&!("object"==s&&d in Object&&T===Object[d])){var j=l[this._name];for(l[this._name]=T,l[this._name+"$index"]=p,l[this._name+"$iteration"]=g,l[this._name+"$first"]=0===g,l[this._name+"$last"]=p+h>=u,l[this._name+"$total"]=y,l[this._name+"$key"]=void 0!==d&&d.constructor==String?this._template.f_escapeString(d):d,l[this._name+"$typeof"]=typeof T,c=0,_=this._onTrue.length;c<_;++c)try{m+=this._onTrue[c].get(l,t,a,n)}catch(e){if(!(e instanceof JTException))throw e;switch(e.type){case"continue":c=_;break;case"break":c=_,p=u;break;default:throw e}}delete l[this._name+"$index"],delete l[this._name+"$iteration"],delete l[this._name+"$first"],delete l[this._name+"$last"],delete l[this._name+"$total"],delete l[this._name+"$key"],delete l[this._name+"$typeof"],delete l[this._name],l[this._name]=j}}else for(c=0,_=this._onFalse.length;c<_;++c)m+=this._onFalse[c].get(e,t,a,n);return m}catch(u){if(Template.DEBUG_MODE||u instanceof JTException)throw u;return""}};var JTException=function(e){this.type=e};JTException.prototype=Error,JTException.prototype.get=function(e){throw this};var Include=function(e,t,a){if(e.match(/\{#include (.*?)(?: root=(.*?))?\}/),this._template=t[RegExp.$1],void 0==this._template&&Template.DEBUG_MODE)throw new Error("jTemplates: Cannot find include: "+RegExp.$1);this._root=RegExp.$2,this._mainTempl=a};Include.prototype.get=function(e,t,a,n){try{return this._template.get(this._mainTempl.getBin().evaluate(e,t,a,this._root),t,a,n)}catch(e){if(Template.DEBUG_MODE||e instanceof JTException)throw e}return""};var UserParam=function(e,t){e.match(/\{#param name=(\w*?) value=(.*?)\}/),this._name=RegExp.$1,this._value=RegExp.$2,this._templ=t};UserParam.prototype.get=function(e,t,a,n){try{t[this._name]=this._templ.getBin().evaluate(e,t,a,this._value)}catch(e){if(Template.DEBUG_MODE||e instanceof JTException)throw e;t[this._name]=void 0}return""};var UserVariable=function(e,t){e.match(/\{#var (.*?)\}/),this._id=RegExp.$1,this._templ=t};UserVariable.prototype.get=function(e,t,a,n){try{if(void 0==a)return"";var i=this._templ.getBin().evaluate(e,t,a,this._id),r=jQuery.data(a,"jTemplatesRef");void 0==r&&(r={guid:++Template.guid,d:[]});var s=r.d.push(i);return jQuery.data(a,"jTemplatesRef",r),"(TemplateUtils.ReturnRefValue(this,"+r.guid+","+(s-1)+"))"}catch(e){if(Template.DEBUG_MODE||e instanceof JTException)throw e;return""}};var Cycle=function(oper){if(oper.match(/\{#cycle values=(.*?)\}/),this._values=eval(RegExp.$1),this._length=this._values.length,this._length<=0)throw new Error("jTemplates: no elements for cycle");this._index=0,this._lastSessionID=-1};Cycle.prototype.get=function(e,t,a,n){var i=jQuery.data(a,"jTemplateSID");i!=this._lastSessionID&&(this._lastSessionID=i,this._index=0);var r=this._index++%this._length;return this._values[r]},jQuery.fn.setTemplate=function(e,t,a){return jQuery(this).each(function(){var n=e&&e.constructor==Template?e:new Template(e,t,a);jQuery.data(this,"jTemplate",n),jQuery.data(this,"jTemplateSID",0)})},jQuery.fn.setTemplateURL=function(e,t,a){var n=jQuery.ajax({url:e,dataType:"text",async:!1,type:"GET"}).responseText;return jQuery(this).setTemplate(n,t,a)},jQuery.fn.setTemplateElement=function(e,t,a){var n=jQuery("#"+e).val();return null==n&&(n=(n=jQuery("#"+e).html()).replace(/&lt;/g,"<").replace(/&gt;/g,">")),n=(n=(n=jQuery.trim(n)).replace(/^<\!\[CDATA\[([\s\S]*)\]\]>$/im,"$1")).replace(/^<\!--([\s\S]*)-->$/im,"$1"),jQuery(this).setTemplate(n,t,a)},jQuery.fn.hasTemplate=function(){var e=0;return jQuery(this).each(function(){jQuery.getTemplate(this)&&++e}),e},jQuery.fn.removeTemplate=function(){return jQuery(this).processTemplateStop(),jQuery(this).each(function(){jQuery.removeData(this,"jTemplate")})},jQuery.fn.setParam=function(e,t){return jQuery(this).each(function(){var a=jQuery.getTemplate(this);if(null!=a)a.setParam(e,t);else if(Template.DEBUG_MODE)throw new Error("jTemplates: Template is not defined.")})},jQuery.fn.processTemplate=function(e,t,a){return jQuery(this).each(function(){var n=jQuery.getTemplate(this);if(null!=n)void 0!=a&&a.StrToJSON&&(e=n.f_parseJSON(e)),jQuery.data(this,"jTemplateSID",jQuery.data(this,"jTemplateSID")+1),jQuery(this).html(n.get(e,t,this,0));else if(Template.DEBUG_MODE)throw new Error("jTemplates: Template is not defined.")})},jQuery.fn.processTemplateURL=function(e,t,a){var n=this,i=jQuery.extend({cache:!1},jQuery.ajaxSettings);return i=jQuery.extend(i,a),jQuery.ajax({url:e,type:i.type,data:i.data,dataFilter:i.dataFilter,async:i.async,cache:i.cache,timeout:i.timeout,dataType:"text",success:function(e){var a=jQuery(n).processTemplate(e,t,{StrToJSON:!0});i.on_success&&i.on_success(a)},error:i.on_error,complete:i.on_complete}),this};var Updater=function(e,t,a,n,i,r){this._url=e,this._param=t,this._interval=a,this._args=n,this.objs=i,this.timer=null,this._options=r||{};var s=this;jQuery(i).each(function(){jQuery.data(this,"jTemplateUpdater",s)}),this.run()};Updater.prototype.run=function(){if(this.objs=jQuery.grep(this.objs,function(e){return jQuery.contains(document.body,e.jquery?e[0]:e)}),0!==this.objs.length){var e=this;jQuery.ajax({url:this._url,dataType:"text",data:this._args,cache:!1,success:function(t){try{var a=jQuery(e.objs).processTemplate(t,e._param,{StrToJSON:!0});e._options.on_success&&e._options.on_success(a)}catch(e){}}}),this.timer=setTimeout(function(){e.run()},this._interval)}},jQuery.fn.processTemplateStart=function(e,t,a,n,i){return new Updater(e,t,a,n,this,i)},jQuery.fn.processTemplateStop=function(){return jQuery(this).each(function(){var e=jQuery.data(this,"jTemplateUpdater");if(null!=e){var t=this;e.objs=jQuery.grep(e.objs,function(e){return e!=t}),jQuery.removeData(this,"jTemplateUpdater")}})},jQuery.extend({createTemplate:function(e,t,a){return new Template(e,t,a)},createTemplateURL:function(e,t,a){var n=jQuery.ajax({url:e,dataType:"text",async:!1,type:"GET"}).responseText;return new Template(n,t,a)},getTemplate:function(e){return jQuery.data(e,"jTemplate")},processTemplateToText:function(e,t,a){return e.get(t,a,void 0,0)},jTemplatesDebugMode:function(e){Template.DEBUG_MODE=e}})}(jQuery);